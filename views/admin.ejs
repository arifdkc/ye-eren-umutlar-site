<!DOCTYPE html>
<html lang="tr">

<head>
    <%- include("partials/head") %>
        <link rel="stylesheet" href="/css/admin.css">
</head>

<body>
    <header class="admin-header">
        <div class="container">
            <h1>Yeni Umutlar Anaokulu Yönetim Paneli</h1>
            <p>Tüm site ayarlarını buradan yönetebilirsiniz.</p>
        </div>
    </header>

    <main class="admin-main container">
        <section class="admin-section card">
            <h2><i class="fas fa-users"></i> Kullanıcılar</h2>
            <table id="userTable" class="admin-table">
                <thead>
                    <tr>
                        <th onclick="sortTable(0)">İsim <i class="fas fa-sort"></i></th>
                        <th onclick="sortTable(1)">Sınıf <i class="fas fa-sort"></i></th>
                        <th onclick="sortTable(2)">Email <i class="fas fa-sort"></i></th>
                        <th onclick="sortTable(3)">Rol <i class="fas fa-sort"></i></th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    <% user.forEach(user=> { %>
                        <tr>
                            <td data-label="İsim"><a href="/admin/adminPayments/<%= user._id %>">
                                    <%= user.name %>
                                </a></td>
                            <td data-label="Sınıf">
                                <%= user.className || '-' %>
                            </td>
                            <td data-label="Email">
                                <%= user.email %>
                            </td>
                            <td data-label="Rol">
                                
                                <% if (user.role === 'admin') { %> Yönetici <% } %>
                                <% if (user.role === 'moderator') { %> Öğretmen <% } %>
                                <% if (user.role === 'user') { %> Öğrenci <% } %>
                            </td>
                            <td data-label="İşlemler">
                                <form action="/admin/delete-user/<%= user._id %>" method="POST"
                                    onsubmit="return confirm('Bu kullanıcıyı silmek istediğinize emin misiniz?');"
                                    class="delete-form">
                                    <button type="submit" class="btn btn-danger"><i class="fas fa-trash-alt"></i>
                                        Sil</button>
                                </form>
                            </td>
                        </tr>
                        <% }) %>
                </tbody>
            </table>
        </section>

        <div class="forms-grid">
            <section class="admin-section card">
                <h2><i class="fas fa-user-plus"></i> Yeni Kullanıcı Ekle</h2>
                <form action="/admin/add-announcement" method="POST" enctype="multipart/form-data" class="admin-form">
                    <div class="form-group">
                        <label for="name">İsim:</label>
                        <input type="text" id="name" name="name" placeholder="İsim" required>
                    </div>
                    <div class="form-group">
                        <label for="profileImage">Profil Görseli:</label>
                        <input type="file" id="profileImage" name="profileImage" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="email">E-posta:</label>
                        <input type="email" id="email" name="email" placeholder="Email" required>
                    </div>
                    <div class="form-group">
                        <label for="password">Şifre:</label>
                        <input type="password" id="password" name="password" placeholder="Şifre" required>
                    </div>
                    <div class="form-group">
                        <label for="role">Rol:</label>
                        <select id="role" name="role" required>
                            <option value="moderator">Öğretmen</option>
                            <option value="user">Öğrenci</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="className">Sınıf Adı:</label>
                        <input type="text" id="className" name="className" placeholder="Sınıf Adı" required>
                    </div>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-plus-circle"></i> Kullanıcı
                        Ekle</button>
                </form>
            </section>

            <section class="admin-section card">
                <h2><i class="fas fa-bullhorn"></i> Yeni Duyuru Ekle</h2>
                <form action="/announcementIMG" method="POST" enctype="multipart/form-data" class="admin-form">
                    <div class="form-group">
                        <label for="title">Başlık:</label>
                        <input type="text" name="title" id="title" required>
                    </div>
                    <div class="form-group">
                        <label for="description">Açıklama:</label>
                        <textarea name="description" id="description" rows="4"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="image">Görsel:</label>
                        <input type="file" name="image" id="image" accept="image/*">
                    </div>
                    <div class="form-group">
                        <label for="part">Hedef Sınıf:</label>
                        <select name="part" id="part" required>
                            <option value="general">Genel</option>
                            <% classes.forEach(c=> { %>
                                <option value="<%= c %>">
                                    <%= c %>
                                </option>
                                <% }) %>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Duyuru
                        Ekle</button>
                </form>
            </section>

            <section class="admin-section card">
                <h2><i class="fas fa-upload"></i> Haftalık Dosya Yükle</h2>
                <form action="/admin/upload-weekly" method="POST" enctype="multipart/form-data" class="admin-form">
                    <div class="form-group">
                        <label>Ders Programı PDF:</label>
                        <input type="file" name="schedulePdf" accept="application/pdf" required>
                    </div>
                    <div class="form-group">
                        <label>Yemek Listesi PDF:</label>
                        <input type="file" name="menuPdf" accept="application/pdf" required>
                    </div>
                    <button type="submit" class="btn btn-primary"><i class="fas fa-file-upload"></i> Yükle</button>
                </form>
            </section>
        </div>
    </main>

    <%- include("partials/footer") %>
        <script src="/js/scripts.js"></script>

</body>

</html>