<!DOCTYPE html>
<html lang="tr">

<head>
    <%- include("partials/head") %>
        <link rel="stylesheet" href="/css/user.css">
</head>

<body>
    <%- include("partials/navbar") %>

        <main class="panel-container card-container">
            <header class="user-header">
                <div class="profile-image-container">
                    <img src="/uploads/<%= user.profileImage %>" alt="<%= user.name %> profil resmi">
                </div>
                <h1>HoÅŸ geldin, <%= user.name %>!</h1>
            </header>

            <section class="card user-dashboard">
                <ul class="user-options-list">
                    <li>
                        <a href="/messages/<%= user.id %>">
                            <i class="fas fa-envelope"></i> Mesajlar
                        </a>
                    </li>
                    <% if (user.role==='user' ) { %>
                        <li>
                            <a href="/payments/<%= user.id %>">
                                <i class="fas fa-wallet"></i> Ã–deme PlanÄ±nÄ± GÃ¶rÃ¼ntÃ¼le
                            </a>
                        </li>
                        <% } %>
                            <% if (user.role==='moderator' ) { %>
                                <li>
                                    <a href="/moderator">
                                        <i class="fas fa-cog"></i> ModeratÃ¶r Paneli
                                    </a>
                                </li>
                                <% } %>
                                    <% if (user.role==='admin' ) { %>
                                        <li>
                                            <a href="/admin">
                                                <i class="fas fa-user-shield"></i> YÃ¶netici Paneli
                                            </a>
                                        </li>
                                        <% } %>
                </ul>
            </section>
<% posts.forEach((post, index) => { %>
    <div class="post-container">
        <p class="post-text"><%= post.text %></p>

        <% if (post.images.length > 0) { %>
            <div class="slider-container">
                <div class="slider-wrapper" id="slider-wrapper-<%= index %>">
                    <% post.images.forEach(image => { %>
                        <div class="slider-image-wrapper">
                            <img src="/uploads/<%= image.filename %>" class="slider-image">
                            <a href="/uploads/<%= image.filename %>" download class="download-button">ðŸ“¥ Ä°ndir</a>
                            <% if (user.role==='moderator') { %>
                                <form action="/moderator/delete-post/<%= post._id %>" method="POST"
                                    onsubmit="return confirm('Bu postu silmek istediÄŸinizden emin misiniz?');">
                                    <button type="submit" class="delete-btn"><i class="fas fa-trash-alt"></i> Sil</button>
                                </form>
                            <% } %>
                        </div>
                    <% }) %>
                </div>

                <% if (post.images.length > 1) { %>
                    <button class="slider-nav-button prev" onclick="moveSlider(-1, '<%= index %>')">
                        <span class="arrow">&#10094;</span>
                    </button>
                    <button class="slider-nav-button next" onclick="moveSlider(1, '<%= index %>')">
                        <span class="arrow">&#10095;</span>
                    </button>
                <% } %>
            </div>
        <% } %>

        <p class="date"><%= new Date(post.createdAt).toLocaleString("tr-TR", { day: "2-digit", month: "2-digit", year: "2-digit", hour: "2-digit", minute: "2-digit" }) %></p>
    </div>
<% }) %>


        </main>

        <%- include("partials/footer") %>
            <script src="/js/scripts.js"></script>
            <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</body>

</html>